<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"> <style>
	.KEYW {color: #933;}
	.COMM {color: #bbb; font-style: italic;}
	.NUMB {color: #393;}
	.STRN {color: #393;}
	.REGX {color: #339;}
	.linenumber {border-right: 1px dotted #666; color: #666; font-style: normal;}
	</style></head><body><pre><span class='linenumber'>  1</span> <span class="COMM">// $Id: ElementaryFilter.js 131 2008-03-13 10:52:56Z dandfra $</span><span class="WHIT">
<span class='linenumber'>  2</span> 
<span class='linenumber'>  3</span> </span><span class="NAME">Ext.namespace</span><span class="PUNC">(</span><span class="STRN">'Ext.ux.netbox.core'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>  4</span> 
<span class='linenumber'>  5</span> </span><span class="COMM">/** Build a new elementaryFilter. The second (optional) argument is the operator for the elementaryFilter.
<span class='linenumber'>  6</span>   * If none is supplied, is the default operator of the field.
<span class='linenumber'>  7</span>   * If the second argument is undefined or null and the default operator is null an exception is thrown.
<span class='linenumber'>  8</span>   * If the operator is supplied but it's not supported by the field an exception is thrown.
<span class='linenumber'>  9</span>   * @class An elementary filter is a condition on a field. For example state='California' is an elementary filter. In this example state is the field, = is the operator and 'California' is the value.
<span class='linenumber'> 10</span>   * An "exportable" rapresentation of a filter is an object in this format:
<span class='linenumber'> 11</span>   * &lt;pre> {fieldId: &lt; The id of the field &mt;, operatorId: &lt;The id of the operator &mt;, values: &lt; The values &mt;}&lt;/pre>
<span class='linenumber'> 12</span>   * An elementary filter has an id, but is automatically generated, it's not exported by getFilterObj
<span class='linenumber'> 13</span>   * @constructor
<span class='linenumber'> 14</span>   * @param {Ext.ux.netbox.core.Field} field The Field owner of this elementaryFilter.
<span class='linenumber'> 15</span>   * @param {Ext.ux.netbox.core.Operator} operator Optional. The Operator for the filter. If not supplied the default operator is used.
<span class='linenumber'> 16</span>   * @extends Ext.ux.netbox.core.Filter
<span class='linenumber'> 17</span>   */</span><span class="WHIT">
<span class='linenumber'> 18</span> </span><span class="NAME">Ext.ux.netbox.core.ElementaryFilter</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">field</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">operator</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 19</span> </span><span class="WHIT">  </span><span class="NAME">Ext.ux.netbox.core.ElementaryFilter.superclass.constructor.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 20</span> </span><span class="WHIT">  </span><span class="NAME">this.addEvents</span><span class="PUNC">(</span><span class="COMM">/** @scope Ext.ux.netbox.core.ElementaryFilter.prototype */</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 21</span> </span><span class="WHIT">    </span><span class="COMM">/** Fires when a operator is changed
<span class='linenumber'> 22</span>       * @event operatorChanged
<span class='linenumber'> 23</span>       * @param {Ext.ux.netbox.core.ElementaryFilter} elementaryFilter The elementaryFilter that fires the event.
<span class='linenumber'> 24</span>       * @param {Ext.ux.operator} operator The new operator
<span class='linenumber'> 25</span>       */</span><span class="WHIT">
<span class='linenumber'> 26</span> </span><span class="WHIT">    </span><span class="NAME">operatorChanged</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 27</span> </span><span class="WHIT">    </span><span class="COMM">/** Fires when a value is changed
<span class='linenumber'> 28</span>       * @event valueChanged
<span class='linenumber'> 29</span>       * @param {Ext.ux.netbox.core.ElementaryFilter} elementaryFilter The elementaryFilter that fires the event.
<span class='linenumber'> 30</span>       * @param {String} value The new changed value
<span class='linenumber'> 31</span>       */</span><span class="WHIT">
<span class='linenumber'> 32</span> </span><span class="WHIT">    </span><span class="NAME">valueChanged</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="WHIT">
<span class='linenumber'> 33</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 34</span> </span><span class="WHIT">  </span><span class="COMM">/** The id of this elementaryFilter
<span class='linenumber'> 35</span>     * @type String
<span class='linenumber'> 36</span>     * @private
<span class='linenumber'> 37</span>     */</span><span class="WHIT">
<span class='linenumber'> 38</span> </span><span class="WHIT">  </span><span class="NAME">this.id</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">field.getId</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">Ext.ux.netbox.core.ElementaryFilter.sequence</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 39</span> </span><span class="WHIT">  </span><span class="NAME">Ext.ux.netbox.core.ElementaryFilter.sequence</span><span class="PUNC">++</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 40</span> 
<span class='linenumber'> 41</span> </span><span class="WHIT">  </span><span class="COMM">/** The Field that owns this elementaryFilter
<span class='linenumber'> 42</span>     * @type Ext.ux.netbox.core.Field
<span class='linenumber'> 43</span>     * @private
<span class='linenumber'> 44</span>     */</span><span class="WHIT">
<span class='linenumber'> 45</span> </span><span class="WHIT">  </span><span class="NAME">this.field</span><span class="PUNC">=</span><span class="NAME">field</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 46</span> 
<span class='linenumber'> 47</span> </span><span class="WHIT">  </span><span class="COMM">/** The Operator of this elementaryFilter
<span class='linenumber'> 48</span>     * @type Ext.ux.netbox.core.Operator
<span class='linenumber'> 49</span>     * @private
<span class='linenumber'> 50</span>     */</span><span class="WHIT">
<span class='linenumber'> 51</span> </span><span class="WHIT">  </span><span class="NAME">this.operator</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 52</span> </span><span class="WHIT">  </span><span class="NAME">this.setOperator</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">operator</span><span class="PUNC">==</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="NAME">field.getDefaultOperator</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">operator</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 53</span> 
<span class='linenumber'> 54</span> </span><span class="WHIT">  </span><span class="COMM">/** The list of values associated to this elementaryFilter
<span class='linenumber'> 55</span>     * @property {Object} values The values associated to this elementaryFilter
<span class='linenumber'> 56</span>     * @private
<span class='linenumber'> 57</span>     */</span><span class="WHIT">
<span class='linenumber'> 58</span> </span><span class="WHIT">  </span><span class="NAME">this.values</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 59</span> </span><span class="WHIT">  </span><span class="NAME">this.setValues</span><span class="PUNC">(</span><span class="NAME">this.getOperator</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">getDefaultValues</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 60</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 61</span> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">Ext.ux.netbox.core.ElementaryFilter.sequence</span><span class="PUNC">==</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 62</span> </span><span class="WHIT">  </span><span class="NAME">Ext.ux.netbox.core.ElementaryFilter.sequence</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 63</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 64</span> 
<span class='linenumber'> 65</span> </span><span class="NAME">Ext.extend</span><span class="PUNC">(</span><span class="NAME">Ext.ux.netbox.core.ElementaryFilter</span><span class="PUNC">,</span><span class="NAME">Ext.ux.netbox.core.Filter</span><span class="PUNC">,</span><span class="COMM">/** @scope Ext.ux.netbox.core.ElementaryFilter.prototype */</span><span class="WHIT">
<span class='linenumber'> 66</span> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 67</span> </span><span class="WHIT">  </span><span class="COMM">/** This method returns the Field for this elementaryFilter.
<span class='linenumber'> 68</span>     * @return {Ext.ux.netbox.core.ElementaryField} The Field for this elementaryFilter
<span class='linenumber'> 69</span>     */</span><span class="WHIT">
<span class='linenumber'> 70</span> </span><span class="WHIT">  </span><span class="NAME">getField</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 71</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="PUNC">(</span><span class="NAME">this.field</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 72</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 73</span> </span><span class="WHIT">  </span><span class="COMM">/** This method returns the Operator for this elementaryFilter.
<span class='linenumber'> 74</span>     * @return {Ext.ux.netbox.core.Operator} The Operator for this elementaryFilter
<span class='linenumber'> 75</span>     */</span><span class="WHIT">
<span class='linenumber'> 76</span> </span><span class="WHIT">  </span><span class="NAME">getOperator</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 77</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="PUNC">(</span><span class="NAME">this.operator</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 78</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 79</span> </span><span class="WHIT">  </span><span class="COMM">/** This method sets the Operator for this elementaryFilter passing the Ext.ux.netbox.core.Operator or a String containing the operator's Id.
<span class='linenumber'> 80</span>     * If the operator is not supported by the elementaryFilter an exception is throw. This function fires the operatorChanged event.
<span class='linenumber'> 81</span>     * The old value of the elementaryFilter is converted using the covertValue method of the new operator.
<span class='linenumber'> 82</span>     * @param {Ext.ux.netbox.core.Operator or String} operator The Operator for this elementaryFilter or the operator's Id
<span class='linenumber'> 83</span>     * @throw {String} If the operator is not supported by the elementaryFilter
<span class='linenumber'> 84</span>     */</span><span class="WHIT">
<span class='linenumber'> 85</span> </span><span class="WHIT">  </span><span class="NAME">setOperator</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">operator</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 86</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">operator</span><span class="PUNC">==</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 87</span> </span><span class="WHIT">      </span><span class="KEYW">throw</span><span class="PUNC">(</span><span class="STRN">"Null Operator not allowed"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 88</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 89</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">operator.getId</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 90</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.field.getAvailableOperatorById</span><span class="PUNC">(</span><span class="NAME">operator.getId</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">throw</span><span class="PUNC">(</span><span class="STRN">"Operator "</span><span class="PUNC">+</span><span class="NAME">operator.getId</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">" is not available for this elementaryFilter"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 91</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 92</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">operatorTmp</span><span class="PUNC">=</span><span class="NAME">this.getField</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">getAvailableOperatorById</span><span class="PUNC">(</span><span class="NAME">operator</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 93</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">operatorTmp</span><span class="PUNC">==</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 94</span> </span><span class="WHIT">        </span><span class="KEYW">throw</span><span class="PUNC">(</span><span class="STRN">"Operator "</span><span class="PUNC">+</span><span class="NAME">operator</span><span class="PUNC">+</span><span class="STRN">" is not available for this elementaryFilter"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 95</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 96</span> </span><span class="WHIT">      </span><span class="NAME">operator</span><span class="PUNC">=</span><span class="NAME">operatorTmp</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 97</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 98</span> </span><span class="WHIT">    </span><span class="NAME">this.operator</span><span class="PUNC">=</span><span class="NAME">operator</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 99</span> </span><span class="WHIT">    </span><span class="NAME">this.fireEvent</span><span class="PUNC">(</span><span class="STRN">"operatorChanged"</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">operator</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>100</span> </span><span class="WHIT">    </span><span class="NAME">this.setValues</span><span class="PUNC">(</span><span class="NAME">this.operator.convertValue</span><span class="PUNC">(</span><span class="NAME">this.getValues</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>101</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>102</span> </span><span class="WHIT">  </span><span class="COMM">/** This method returns the value for this elementaryFilter.
<span class='linenumber'>103</span>     * @return {Array} The array of values for this elementaryFilter
<span class='linenumber'>104</span>     */</span><span class="WHIT">
<span class='linenumber'>105</span> </span><span class="WHIT">  </span><span class="NAME">getValues</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>106</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.values</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>107</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="PUNC">(</span><span class="NAME">this.values.concat</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>108</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>109</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="PUNC">(</span><span class="NAME">this.values</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>110</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>111</span> </span><span class="WHIT">  </span><span class="COMM">/** This method add a value for this elementaryFilter.
<span class='linenumber'>112</span>     * @param {String} value A value to add for this elementaryFilter
<span class='linenumber'>113</span>     */</span><span class="WHIT">
<span class='linenumber'>114</span> </span><span class="WHIT">  </span><span class="NAME">addValue</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">val</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>115</span> </span><span class="WHIT">    </span><span class="NAME">this.values.push</span><span class="PUNC">(</span><span class="NAME">val</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>116</span> </span><span class="WHIT">    </span><span class="NAME">this.fireEvent</span><span class="PUNC">(</span><span class="STRN">"valueChanged"</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">val</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>117</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>118</span> </span><span class="WHIT">  </span><span class="COMM">/** This method remove a value for this elementaryFilter. If the value is not found an exception is thrown.
<span class='linenumber'>119</span>     * @throw {String} When the given value is not found
<span class='linenumber'>120</span>     * @param {String} value The value to remove for this Filter
<span class='linenumber'>121</span>     */</span><span class="WHIT">
<span class='linenumber'>122</span> </span><span class="WHIT">  </span><span class="NAME">removeValue</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">val</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>123</span> </span><span class="WHIT">    </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">find</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="WHIT">
<span class='linenumber'>124</span> </span><span class="WHIT">    </span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">&lt;</span><span class="NAME">this.getValues</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">length</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>125</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.getValues</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">==</span><span class="NAME">val</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>126</span> </span><span class="WHIT">        </span><span class="NAME">find</span><span class="PUNC">=</span><span class="NAME">i</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>127</span> </span><span class="WHIT">        </span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>128</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>129</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>130</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">find</span><span class="PUNC">!=</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>131</span> </span><span class="WHIT">      </span><span class="NAME">this.values.splice</span><span class="PUNC">(</span><span class="NAME">find</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>132</span> </span><span class="WHIT">      </span><span class="NAME">this.fireEvent</span><span class="PUNC">(</span><span class="STRN">"valueChanged"</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">val</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>133</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>134</span> </span><span class="WHIT">      </span><span class="KEYW">throw</span><span class="PUNC">(</span><span class="STRN">"Unable to remove the value "</span><span class="PUNC">+</span><span class="NAME">val</span><span class="PUNC">+</span><span class="STRN">". Not found"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>135</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>136</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>137</span> </span><span class="WHIT">  </span><span class="COMM">/** This method set a list of values for this elementaryFilter. This method fires a valueChanged event.
<span class='linenumber'>138</span>     * The values must be an Array. If it's not an array an exception is thrown.
<span class='linenumber'>139</span>     * The empty value is an empty array. If values is null or undefined an exception is thrown.
<span class='linenumber'>140</span>     * If the given values are equal (compared using json encode) to the actual values, no event is fired.
<span class='linenumber'>141</span>     * @param {Array} values The values for this elementaryFilter
<span class='linenumber'>142</span>     */</span><span class="WHIT">
<span class='linenumber'>143</span> </span><span class="WHIT">  </span><span class="NAME">setValues</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">values</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>144</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">values</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">values</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>145</span> </span><span class="WHIT">      </span><span class="KEYW">throw</span><span class="PUNC">(</span><span class="STRN">"ElementaryFilter "</span><span class="PUNC">+</span><span class="NAME">this.getId</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">". Impossible to set a undefined or null value. The empty value is an empty array."</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>146</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>147</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">Ext.type</span><span class="PUNC">(</span><span class="NAME">values</span><span class="PUNC">)</span><span class="PUNC">!=</span><span class="STRN">"array"</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>148</span> </span><span class="WHIT">      </span><span class="KEYW">throw</span><span class="PUNC">(</span><span class="STRN">"ElementaryFilter "</span><span class="PUNC">+</span><span class="NAME">this.getId</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">". The value of a ElementaryFilter MUST be an array!"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>149</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>150</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">Ext.util.JSON.encode</span><span class="PUNC">(</span><span class="NAME">this.values</span><span class="PUNC">)</span><span class="PUNC">!=</span><span class="NAME">Ext.util.JSON.encode</span><span class="PUNC">(</span><span class="NAME">values</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>151</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.getOperator</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">validate</span><span class="PUNC">(</span><span class="NAME">values</span><span class="PUNC">)</span><span class="PUNC">===</span><span class="KEYW">true</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">this.getOperator</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">validate</span><span class="PUNC">(</span><span class="NAME">this.getValues</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">!==</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>152</span> </span><span class="WHIT">        </span><span class="NAME">this.values</span><span class="PUNC">=</span><span class="NAME">values</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>153</span> </span><span class="WHIT">        </span><span class="NAME">this.fireEvent</span><span class="PUNC">(</span><span class="STRN">"valueChanged"</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">values</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>154</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>155</span> </span><span class="WHIT">        </span><span class="WHIT">
<span class='linenumber'>156</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>157</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>158</span> </span><span class="WHIT">  </span><span class="COMM">/** This method returns a javascript object representing the elementaryFilter.&lt;BR>
<span class='linenumber'>159</span>     * The format is the following:
<span class='linenumber'>160</span>     * &lt;PRE>{fieldId : "&lt;fieldId&gt;", operatorId : "&lt;operatorId&gt;", values : [...]}&lt;/PRE>
<span class='linenumber'>161</span>     * @return {Object} A javascript object rapresenting the elementaryFilter.
<span class='linenumber'>162</span>     */</span><span class="WHIT">
<span class='linenumber'>163</span> </span><span class="WHIT">  </span><span class="NAME">getFilterObj</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>164</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">fieldId</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">this.getField</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">getId</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">operatorId</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">this.getOperator</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">getId</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">values</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">this.getValues</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>165</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>166</span> </span><span class="WHIT">  </span><span class="COMM">/** This method, given a javascript object representing an elementaryFilter, sets the elementaryFilter itself.&lt;BR>
<span class='linenumber'>167</span>     * The format is the following:
<span class='linenumber'>168</span>     * &lt;PRE>{fieldId : "&lt;fieldId&gt;", operatorId : "&lt;operatorId&gt;", values : [...]}&lt;/PRE>
<span class='linenumber'>169</span>     * @param {Object} filter The object containing the elementaryFilter to set
<span class='linenumber'>170</span>     * @throw {String} if the fieldId passed is not the same of the actual one
<span class='linenumber'>171</span>     */</span><span class="WHIT">
<span class='linenumber'>172</span> </span><span class="WHIT">  </span><span class="NAME">setFilterObj</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">filter</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>173</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.getField</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">getId</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">!=</span><span class="NAME">filter.fieldId</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>174</span> </span><span class="WHIT">      </span><span class="KEYW">throw</span><span class="PUNC">(</span><span class="STRN">"Wrong field for this filter. Expected "</span><span class="PUNC">+</span><span class="NAME">this.getField</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">getId</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">" got "</span><span class="PUNC">+</span><span class="NAME">filter.fieldId</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>175</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>176</span> </span><span class="WHIT">    </span><span class="NAME">this.setOperator</span><span class="PUNC">(</span><span class="NAME">this.getField</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">getAvailableOperatorById</span><span class="PUNC">(</span><span class="NAME">filter.operatorId</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>177</span> </span><span class="WHIT">    </span><span class="NAME">this.setValues</span><span class="PUNC">(</span><span class="NAME">filter.values</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>178</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>179</span> </span><span class="WHIT">  </span><span class="COMM">/** This method returns the id of current elementaryFilter.
<span class='linenumber'>180</span>     * @return {String} The elementaryFilter's id returned
<span class='linenumber'>181</span>     */</span><span class="WHIT">
<span class='linenumber'>182</span> </span><span class="WHIT">  </span><span class="NAME">getId</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>183</span> </span><span class="WHIT">  	</span><span class="KEYW">return</span><span class="PUNC">(</span><span class="NAME">this.id</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>184</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>185</span> </span><span class="WHIT">  </span><span class="COMM">/** This method get an Ext.ux.netbox.core.ElementaryFilter by id or null if not found.
<span class='linenumber'>186</span>     * @param {String} id The elementaryFilter's id
<span class='linenumber'>187</span>     * @return {Ext.ux.netbox.core.ElementaryFilter} The elementaryFilter returned
<span class='linenumber'>188</span>     */</span><span class="WHIT">
<span class='linenumber'>189</span> </span><span class="WHIT">  </span><span class="NAME">getElementaryFilterById</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">id</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>190</span> </span><span class="WHIT">  	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.getId</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="NAME">id</span><span class="PUNC">)</span><span class="WHIT">
<span class='linenumber'>191</span> </span><span class="WHIT">  	  </span><span class="KEYW">return</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>192</span> </span><span class="WHIT">  	</span><span class="KEYW">return</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>193</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>194</span> </span><span class="WHIT">  </span><span class="COMM">/** This method returns an array containig this elementaryFilter by fieldId.
<span class='linenumber'>195</span>     * If not found an empty array is returned.
<span class='linenumber'>196</span>     * @param {String} fieldId The field's id
<span class='linenumber'>197</span>     * @return {Array of Ext.ux.netbox.core.ElementaryFilter} Array with the elementaryFilter returned
<span class='linenumber'>198</span>     */</span><span class="WHIT">
<span class='linenumber'>199</span> </span><span class="WHIT">  </span><span class="NAME">getElementaryFiltersByFieldId</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">fieldId</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>200</span> </span><span class="WHIT">  	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.getField</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">getId</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="NAME">fieldId</span><span class="PUNC">)</span><span class="WHIT">
<span class='linenumber'>201</span> </span><span class="WHIT">  	  </span><span class="KEYW">return</span><span class="PUNC">(</span><span class="PUNC">[</span><span class="KEYW">this</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>202</span> </span><span class="WHIT">  	</span><span class="KEYW">return</span><span class="PUNC">(</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>203</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>204</span> </span><span class="WHIT">  </span><span class="COMM">/** This method controls if the values is setted for this elementaryFilter.
<span class='linenumber'>205</span>     * @return {boolean} true if this elementaryFilter is valid, false otherwise
<span class='linenumber'>206</span>     */</span><span class="WHIT">
<span class='linenumber'>207</span> </span><span class="WHIT">  </span><span class="NAME">isValid</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>208</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.values</span><span class="PUNC">!==</span><span class="NAME">undefined</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">this.getOperator</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">validate</span><span class="PUNC">(</span><span class="NAME">this.values</span><span class="PUNC">)</span><span class="PUNC">===</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="WHIT">
<span class='linenumber'>209</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>210</span> </span><span class="WHIT">    </span><span class="KEYW">else</span><span class="WHIT">
<span class='linenumber'>211</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>212</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>213</span> 
<span class='linenumber'>214</span> </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span></pre></body></html>